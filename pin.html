<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>NexPay — Security PIN</title>

<style>
*{
  margin:0;
  padding:0;
  box-sizing:border-box;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;
}

body{
  background:linear-gradient(135deg,#0b0f1a,#101728,#0b0f1a);
  color:#fff;
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
}

.container{
  width:100%;
  max-width:360px;
  padding:28px 24px 32px;
  text-align:center;
}

/* Title */
h2{
  font-size:1.5rem;
  margin-bottom:14px;
  color:#e5f2ff;
}

/* PIN dots */
.pin-dots{
  display:flex;
  justify-content:center;
  gap:14px;
  margin:24px 0 30px;
}
.dot{
  width:14px;
  height:14px;
  border-radius:50%;
  border:2px solid rgba(255,255,255,.4);
}
.dot.filled{
  background:#4db6ff;
  border-color:#4db6ff;
}

/* Keypad */
.keypad{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:14px;
  margin-top:10px;
}
.key{
  height:60px;
  border-radius:16px;
  background:rgba(255,255,255,.08);
  border:1px solid rgba(255,255,255,.12);
  font-size:1.4rem;
  font-weight:600;
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  user-select:none;
}
.key:active{
  transform:scale(.95);
  background:rgba(255,255,255,.15);
}
.key.empty{
  background:transparent;
  border:none;
  pointer-events:none;
}

/* Button */
button{
  width:100%;
  margin-top:26px;
  padding:14px;
  border-radius:14px;
  border:none;
  background:linear-gradient(90deg,#4db6ff,#1976d2);
  color:#fff;
  font-size:1rem;
  font-weight:700;
  cursor:pointer;
}
button:hover{opacity:.95}

/* Alert */
.alert{
  margin-top:18px;
  padding:12px;
  border-radius:12px;
  font-size:.95rem;
  display:none;
}
.alert.error{
  background:rgba(255,77,77,.12);
  color:#ff6b6b;
  border:1px solid rgba(255,77,77,.4);
}
.alert.success{
  background:rgba(77,255,136,.12);
  color:#4dff88;
  border:1px solid rgba(77,255,136,.4);
}
</style>
</head>

<body>

<div class="container">
  <h2 id="title">Create Your PIN</h2>

  <div class="pin-dots" id="dots">
    <div class="dot"></div><div class="dot"></div>
    <div class="dot"></div><div class="dot"></div>
  </div>

  <div id="setupSection">
    <button onclick="savePin()">Save PIN</button>
  </div>

  <div id="loginSection" style="display:none;">
    <button onclick="checkPin()">Login</button>
  </div>

  <div class="keypad">
    <div class="key" onclick="press(1)">1</div>
    <div class="key" onclick="press(2)">2</div>
    <div class="key" onclick="press(3)">3</div>
    <div class="key" onclick="press(4)">4</div>
    <div class="key" onclick="press(5)">5</div>
    <div class="key" onclick="press(6)">6</div>
    <div class="key" onclick="press(7)">7</div>
    <div class="key" onclick="press(8)">8</div>
    <div class="key" onclick="press(9)">9</div>
    <div class="key empty"></div>
    <div class="key" onclick="press(0)">0</div>
    <div class="key" onclick="back()">⌫</div>
  </div>

  <div class="alert" id="alertBox"></div>
</div>

<script>
const storedPin = localStorage.getItem("userPIN");
const setupSection = document.getElementById("setupSection");
const loginSection = document.getElementById("loginSection");
const title = document.getElementById("title");
const alertBox = document.getElementById("alertBox");
const dots = document.querySelectorAll(".dot");

let pinInput = "";
let tempPin = "";

if(storedPin){
  setupSection.style.display="none";
  loginSection.style.display="block";
  title.innerText="Enter Your PIN";
}

function press(num){
  if(pinInput.length >= 4) return;
  pinInput += num;
  updateDots();
}

function back(){
  pinInput = pinInput.slice(0,-1);
  updateDots();
}

function updateDots(){
  dots.forEach((d,i)=>{
    d.classList.toggle("filled", i < pinInput.length);
  });
}

function savePin(){
  if(pinInput.length !== 4){
    showAlert("PIN must be 4 digits","error");
    return;
  }
  if(!tempPin){
    tempPin = pinInput;
    pinInput = "";
    updateDots();
    showAlert("Confirm your PIN","success");
  }else{
    if(tempPin !== pinInput){
      showAlert("PINs do not match","error");
      tempPin="";
      pinInput="";
      updateDots();
      return;
    }
    localStorage.setItem("userPIN", pinInput);
    showAlert("PIN created successfully!","success");
    setTimeout(()=>location.reload(),1500);
  }
}

function checkPin(){
  if(pinInput === storedPin){
    showAlert("Login successful! Redirecting…","success");
    setTimeout(()=>window.location.href="dashboard.html",1500);
  }else{
    showAlert("Incorrect PIN","error");
    pinInput="";
    updateDots();
  }
}

function showAlert(msg,type){
  alertBox.innerText=msg;
  alertBox.className="alert "+type;
  alertBox.style.display="block";
}
</script>

</body>
</html>
