<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>NexPay — Sell Bitcoin</title>
<meta name="theme-color" content="#0b0f1a">
<style>
  :root {
    --bg: #0b0f1a;
    --card: #11182a;
    --pri: #3b82f6;
    --text: #f9fafb;
    --sub: #9ca3af;
    --accent: #22c55e;
    --danger: #ef4444;
  }
  body {margin:0;font-family:"Segoe UI",Tahoma,sans-serif;background:var(--bg);color:var(--text);display:flex;flex-direction:column;min-height:100vh;padding:20px}
  header{text-align:center;margin-bottom:20px}
  header h1{font-size:1.6rem;margin:0}
  .balance{background:var(--card);padding:15px;border-radius:12px;text-align:center;margin-bottom:20px;box-shadow:0 4px 12px rgba(0,0,0,0.4)}
  .balance strong{font-size:1.2rem;color:var(--accent)}
  .input-group{margin-bottom:18px;display:flex;flex-direction:column}
  .input-group label{margin-bottom:6px;font-size:0.9rem;color:var(--sub)}
  .input-group input,.input-group select{padding:12px;border:1px solid #2c3550;border-radius:10px;background:#0f1424;color:var(--text);font-size:1rem;outline:none}
  .input-group input:focus,.input-group select:focus{border-color:var(--pri)}
  .all-btn{margin-top:8px;padding:8px 14px;border:none;border-radius:8px;background:var(--pri);color:#fff;cursor:pointer;font-size:0.9rem;transition:background 0.2s;align-self:flex-start}
  .all-btn:hover{background:#2563eb}
  .details-box{margin-top:20px;padding:15px;border:1px solid #2c3550;border-radius:12px;background:#101828}
  .details-box h3{margin:0 0 10px;font-size:1rem;color:var(--pri)}
  .sell-btn{width:100%;padding:15px;font-size:1.1rem;border:none;border-radius:12px;background:var(--accent);color:#fff;margin-top:25px;cursor:pointer;font-weight:bold;transition:background 0.2s}
  .sell-btn:hover{background:#16a34a}
  .popup{position:fixed;inset:0;background:rgba(0,0,0,0.8);display:none;justify-content:center;align-items:center;z-index:999}
  .popup-content{background:#101828;padding:25px;border-radius:14px;width:90%;max-width:420px;text-align:center;box-shadow:0 6px 20px rgba(0,0,0,0.5)}
  .popup-content h2{margin:0 0 12px;color:var(--pri)}
  .popup-content p{margin:8px 0;color:var(--sub)}
  .confirm-btn,.close-btn{margin-top:18px;padding:12px;border:none;border-radius:10px;cursor:pointer;width:100%;font-size:1rem}
  .confirm-btn{background:var(--pri);color:#fff}
  .close-btn{background:var(--danger);color:#fff}
  .alert-popup{position:fixed;inset:0;background:rgba(0,0,0,0.85);display:none;justify-content:center;align-items:center;z-index:1000}
  .alert-box{background:#111827;color:var(--text);padding:25px;border-radius:14px;max-width:400px;width:90%;text-align:center;box-shadow:0 6px 20px rgba(0,0,0,0.5);animation:pop 0.3s ease}
  .alert-box h3{margin:0;font-size:1.2rem;color:var(--danger)}
  .alert-box p{margin:10px 0;color:var(--sub);font-size:0.95rem}
  .alert-btn{margin-top:18px;padding:10px 16px;border:none;border-radius:10px;background:var(--pri);color:#fff;cursor:pointer;font-size:1rem}
  @keyframes pop{from{transform:scale(0.8);opacity:0}to{transform:scale(1);opacity:1}}
</style>
</head>
<body>
<header>
  <h1>Sell Bitcoin</h1>
</header>

<div class="balance">
  <p>Available Balance</p>
  <strong id="balanceText">0 BTC ≈ $0</strong>
</div>

<div class="input-group">
  <label for="amount">Enter BTC Amount (Minimum 0.0033 BTC)</label>
  <input type="number" id="amount" step="0.0001" min="0.0033" placeholder="0.0033">
  <button class="all-btn" onclick="setAll()">Sell All</button>
</div>

<div class="input-group">
  <label>You Will Receive (NGN)</label>
  <input type="text" id="nairaValue" readonly placeholder="₦0">
</div>

<div class="details-box">
  <h3>Receiver Bank Details</h3>
  <div class="input-group">
    <label for="bank">Select Bank</label>
    <select id="bank">
      <option value="">-- Select Bank --</option>
      <option>Access Bank</option><option>First Bank of Nigeria</option><option>Guaranty Trust Bank</option>
      <option>United Bank for Africa</option><option>Zenith Bank</option><option>Fidelity Bank</option>
      <option>Union Bank</option><option>Opay</option><option>Ecobank</option>
      <option>Stanbic IBTC Bank</option><option>Polaris Bank</option><option>Keystone Bank</option><option>Palmpay</option>
    </select>
  </div>
  <div class="input-group">
    <label for="account">Account Number</label>
    <input type="text" id="account" minlength="9" maxlength="10" placeholder="Enter your 9-10 digit account number">
  </div>
  <div class="input-group">
    <label for="accountName">Account Name</label>
    <input type="text" id="accountName" placeholder="Enter exact name as registered with your bank">
  </div>
  <small style="color:var(--danger);font-size:0.8rem;">
    ⚠ Ensure the account name matches exactly as it appears in your bank records to avoid payment delays.
  </small>
</div>

<button class="sell-btn" onclick="showPopup()">Sell BTC</button>

<!-- Transaction Confirmation Popup -->
<div class="popup" id="popup">
  <div class="popup-content">
    <h2>Confirm Transaction</h2>
    <p><strong>Amount:</strong> 0.0033 BTC</p>
    <p><strong>NGN:</strong> ₦379,055</p>
    <p><strong>Fee:</strong> $3 USDT</p>
    <button class="confirm-btn" onclick="insufficient()">Confirm</button>
    <button class="close-btn" onclick="closePopup()">Cancel</button>
  </div>
</div>

<!-- Custom Alert -->
<div class="alert-popup" id="alertBox">
  <div class="alert-box">
    <h3 id="alertTitle">❌ Insufficient USDT</h3>
    <p id="alertMessage">Please ensure your USDT balance covers the network fee to complete this transaction.</p>
    <button class="alert-btn" onclick="closeAlert()">OK</button>
  </div>
</div>

<script>
  const rate = 379055; // NGN for 0.0025 BTC
  const amountInput = document.getElementById('amount');
  const nairaValue = document.getElementById('nairaValue');
  const bank = document.getElementById('bank');
  const account = document.getElementById('account');
  const accountName = document.getElementById('accountName');
  const balanceText = document.getElementById('balanceText');
  const alertTitle = document.getElementById('alertTitle');
  const alertMessage = document.getElementById('alertMessage');

  // Determine balance from dashboard
  let hasBalance = localStorage.getItem("balanceUpgraded") === "true";
  if(hasBalance){
    balanceText.textContent = "0.0033 BTC ≈ €235";
  } else {
    balanceText.textContent = "0 BTC ≈ €0";
  }

  // Load saved details
  window.onload = () => {
    if(localStorage.getItem('bank')) bank.value = localStorage.getItem('bank');
    if(localStorage.getItem('account')) account.value = localStorage.getItem('account');
    if(localStorage.getItem('accountName')) accountName.value = localStorage.getItem('accountName');
  };

  // Save details
  [bank, account, accountName].forEach(el => {
    el.addEventListener('input', () => {
      localStorage.setItem(el.id, el.value);
    });
  });

  function setAll() {
    if(!hasBalance){
      amountInput.value = 0;
      nairaValue.value = "₦0";
    } else {
      amountInput.value = 0.0033;
      nairaValue.value = "Calculating...";
      setTimeout(() => {
        nairaValue.value = "₦" + rate.toLocaleString();
      }, 4000);
    }
  }

  amountInput.addEventListener('input', () => {
    const val = parseFloat(amountInput.value);
    if(hasBalance && val === 0.0025){
      nairaValue.value = "Calculating...";
      setTimeout(() => {
        nairaValue.value = "₦" + rate.toLocaleString();
      }, 4000);
    } else {
      nairaValue.value = "₦0";
    }
  });

  function showPopup(){
    if(!hasBalance){
      alertTitle.textContent = "❌ Insufficient Balance";
      alertMessage.textContent = "No BTC available to sell";
      document.getElementById('alertBox').style.display = 'flex';
      return;
    }
    if(!amountInput.value || amountInput.value != 0.0033){
      alert("Minimum sell amount is 0.0033 BTC.");
      return;
    }
    if(account.value.length < 9){
      alert("Account number must be at least 9 digits.");
      return;
    }
    if(!bank.value || !account.value || !accountName.value){
      alert("Please complete your bank account details.");
      return;
    }
    document.getElementById('popup').style.display = 'flex';
  }

  function closePopup(){
    document.getElementById('popup').style.display = 'none';
  }

  function insufficient(){
    closePopup();
    setTimeout(() => {
      document.getElementById('alertBox').style.display = 'flex';
      alertTitle.textContent = "❌ Insufficient USDT";
      alertMessage.textContent = "Please ensure your USDT balance covers the network fee to complete this transaction.";
    }, 400);
  }

  function closeAlert(){
    document.getElementById('alertBox').style.display = 'none';
  }
</script>
</body>
</html>
